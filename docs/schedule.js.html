<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>schedule.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-auto-size-input-AutoSizeInput.html">AutoSizeInput</a><ul class='methods'><li data-type='method'><a href="module-auto-size-input-AutoSizeInput.html#_getWidth">_getWidth</a></li><li data-type='method'><a href="module-auto-size-input-AutoSizeInput.html#render">render</a></li></ul></li><li><a href="module-calendar-Calendar.html">Calendar</a><ul class='methods'><li data-type='method'><a href="module-calendar-Calendar.html#render">render</a></li></ul></li><li><a href="module-calendar-CalendarDay.html">CalendarDay</a><ul class='methods'><li data-type='method'><a href="module-calendar-CalendarDay.html#_makeClassName">_makeClassName</a></li><li data-type='method'><a href="module-calendar-CalendarDay.html#render">render</a></li></ul></li><li><a href="module-calendar-CalendarItem.html">CalendarItem</a><ul class='methods'><li data-type='method'><a href="module-calendar-CalendarItem.html#_getPartClassName">_getPartClassName</a></li><li data-type='method'><a href="module-calendar-CalendarItem.html#_onClick">_onClick</a></li><li data-type='method'><a href="module-calendar-CalendarItem.html#render">render</a></li></ul></li><li><a href="module-calendar-CalendarItemEditor.html">CalendarItemEditor</a><ul class='methods'><li data-type='method'><a href="module-calendar-CalendarItemEditor.html#_changed">_changed</a></li><li data-type='method'><a href="module-calendar-CalendarItemEditor.html#render">render</a></li></ul></li><li><a href="module-calendar-CalendarSlot.html">CalendarSlot</a><ul class='methods'><li data-type='method'><a href="module-calendar-CalendarSlot.html#_addItem">_addItem</a></li><li data-type='method'><a href="module-calendar-CalendarSlot.html#componentDidMount">componentDidMount</a></li><li data-type='method'><a href="module-calendar-CalendarSlot.html#render">render</a></li></ul></li><li><a href="module-checkbox-Checkbox.html">Checkbox</a><ul class='methods'><li data-type='method'><a href="module-checkbox-Checkbox.html#render">render</a></li></ul></li><li><a href="module-popover-Popover.html">Popover</a><ul class='methods'><li data-type='method'><a href="module-popover-Popover.html#.hidePopover">hidePopover</a></li><li data-type='method'><a href="module-popover-Popover.html#.showPopover">showPopover</a></li><li data-type='method'><a href="module-popover-Popover.html#_generatePath">_generatePath</a></li><li data-type='method'><a href="module-popover-Popover.html#_onClickedOutside">_onClickedOutside</a></li><li data-type='method'><a href="module-popover-Popover.html#componentDidMount">componentDidMount</a></li><li data-type='method'><a href="module-popover-Popover.html#componentDidUpdate">componentDidUpdate</a></li><li data-type='method'><a href="module-popover-Popover.html#render">render</a></li></ul></li><li><a href="module-schedule-ItemPart.html">ItemPart</a></li><li><a href="module-schedule-Lesson.html">Lesson</a><ul class='methods'><li data-type='method'><a href="module-schedule-Lesson.html#setEndTime">setEndTime</a></li><li data-type='method'><a href="module-schedule-Lesson.html#setStartTime">setStartTime</a></li></ul></li><li><a href="module-schedule-Schedule.html">Schedule</a><ul class='methods'><li data-type='method'><a href="module-schedule-Schedule.html#createItem">createItem</a></li><li data-type='method'><a href="module-schedule-Schedule.html#getEarlistTimeForLesson">getEarlistTimeForLesson</a></li><li data-type='method'><a href="module-schedule-Schedule.html#getItem">getItem</a></li><li data-type='method'><a href="module-schedule-Schedule.html#getLatestTimeForLesson">getLatestTimeForLesson</a></li><li data-type='method'><a href="module-schedule-Schedule.html#remove">remove</a></li></ul></li><li><a href="module-schedule-ScheduleItem.html">ScheduleItem</a><ul class='methods'><li data-type='method'><a href="module-schedule-ScheduleItem.html#setPartsCount">setPartsCount</a></li></ul></li><li><a href="module-select-Select.html">Select</a><ul class='methods'><li data-type='method'><a href="module-select-Select.html#render">render</a></li></ul></li><li><a href="module-timetable-CalendarIndexes.html">CalendarIndexes</a><ul class='methods'><li data-type='method'><a href="module-timetable-CalendarIndexes.html#render">render</a></li></ul></li><li><a href="module-timetable-CalendarLessonTime.html">CalendarLessonTime</a><ul class='methods'><li data-type='method'><a href="module-timetable-CalendarLessonTime.html#_formatTime">_formatTime</a></li><li data-type='method'><a href="module-timetable-CalendarLessonTime.html#_getInputClassName">_getInputClassName</a></li><li data-type='method'><a href="module-timetable-CalendarLessonTime.html#_parseTime">_parseTime</a></li><li data-type='method'><a href="module-timetable-CalendarLessonTime.html#_timeBlur">_timeBlur</a></li><li data-type='method'><a href="module-timetable-CalendarLessonTime.html#_timeChanged">_timeChanged</a></li><li data-type='method'><a href="module-timetable-CalendarLessonTime.html#render">render</a></li></ul></li><li><a href="module-toolbar-ToolBar.html">ToolBar</a><ul class='methods'><li data-type='method'><a href="module-toolbar-ToolBar.html#_onGenerateButtonPressed">_onGenerateButtonPressed</a></li><li data-type='method'><a href="module-toolbar-ToolBar.html#render">render</a></li></ul></li><li><a href="module-weekdays-WeekDay.html">WeekDay</a></li></ul><h3>Modules</h3><ul><li><a href="module-auto-size-input.html">auto-size-input</a></li><li><a href="module-calendar.html">calendar</a></li><li><a href="module-checkbox.html">checkbox</a></li><li><a href="module-generator.html">generator</a><ul class='methods'><li data-type='method'><a href="module-generator.html#~canGenerate">canGenerate</a></li><li data-type='method'><a href="module-generator.html#~generate">generate</a></li></ul></li><li><a href="module-popover.html">popover</a></li><li><a href="module-schedule.html">schedule</a></li><li><a href="module-select.html">select</a></li><li><a href="module-timetable.html">timetable</a></li><li><a href="module-toolbar.html">toolbar</a></li><li><a href="module-utils.html">utils</a><ul class='methods'><li data-type='method'><a href="module-utils.html#~range">range</a></li></ul></li><li><a href="module-weekdays.html">weekdays</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">schedule.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module schedule */

let Utils = require("./utils.js")

/**
 * Класс, хранящий информацию об времени начала и окончания занятия.
 * Предполагается, что каждый день занятия начинаются и заканчиваются в 
 * одно и то же время.
 *
 * @class
 * @property {number} number - Порядковый номер занятия
 * @property {boolean} startTimeDefined - Было ли время начала занятия 
 *                                      введено пользователем
 * @property {boolean} startTimeDefined - Было ли время конца занятия 
 *                                      введено пользователем
 * @property {int} startTime - Время начала занятия в минутах с полуночи
 * @property {int} endTime - Время конца занятия в минутах с полуночи
 */
class Lesson{

    /**
     * @constructor
     * @param  {int} lessonNumber - Порядковый номер занятия
     * @param  {Schedule} schedule - Объект расписания 
     */
    constructor(lessonNumber, schedule){
        this.number = lessonNumber
        this.startTimeDefined = false;
        this.endTimeDefined = false;
        this.startTime = 0;
        this.endTime = 0;

        this._schedule = schedule;
    }

    /**
     * Устанавливает время начала занятия и проверяет его корректоность:
     * &lt;uL>
     * &lt;li>оно не должно превышать времени конца занятия если оно было 
     *     установлено
     * &lt;li>оно не должно превышать следующего исзвесного времени начала занятия 
     * &lt;/ul>
     * 
     * @param {number} time - Время начала занятия в минутах, прошедших с 
     *     полуночи
     */
    setStartTime(time){
        if (this.endTimeDefined &amp;&amp; this.endTime &lt;= time){
            alert("Начало занятия не может быть позже его конца.");
        }else if (time &lt; this._schedule.getEarlistTimeForLesson(this.number)){
            alert("Занятие не может начаться раньше чем закончилось предыдущее");
        }else{
            this.startTime = time;
            this.startTimeDefined = true;
        }
    }

    /**
     * Устанавливает время конца занятия и проверяет его корректоность:
     * &lt;uL>
     * &lt;li>оно не должно быть меньше времени начала занятия если оно было 
     *     установлено
     * &lt;li>оно не должно быть меньше времени предыдущего исзвесного времени 
     *     конца занятия  
     * &lt;/ul>
     * 
     * @param {number} time - Время начала занятия в минутах, прошедших с 
     *     полуночи
     */
    setEndTime(time){
        if (this.startTimeDefined &amp;&amp; this.startTime >= time){
            alert("Конец занятия должен быть позже его начала.");
        }else if (time > this._schedule.getLatestTimeForLesson(this.number)){
            alert("Зянятие не может закончиться позже чем начнется следующее");
        }else{
            this.endTime = time;
            this.endTimeDefined = true;
        }
    }
}

/**
 * Класс, содержащий информацию о одной из вариантов переодического занятия.
 * @param {boolean} active - Определяет является ли занятие активным. 
 *     Если занятие не является активным, оно не будет экспортировано в .ics 
 *     файл и его название не будет отображаться в пользовательском интерфейсе 
 *     календаря.
 * @param {string} name - Название события. По умолчанию используется строка 
 *                        "&lt;без названия>".
 * @param {string} location - Место проведения занятия.
 */
class ItemPart{

    /**
     * @constructor
     */
    constructor(){
        this.active = true;
        this.name = "&lt;без названия>";
        this.location = "";
    }
}

/**
 * Класс, содержащий инфомрацию о занятии, добавленном в календарь.
 *
 * @property {number} partsCount - Количество периодических вариантов собятия.
 * @property {ItemPart[]} parts - Периодические варианты занятия.
 * @property {WeekDay} day - День недели, в который будет проводится занятие.
 *     (0 - понедельник, 6 - воскресенье).
 * @property {Lesson} lesson - Объект, соответствующий времени проведения 
 *     занятия.
 */
class ScheduleItem{
    /**
     * @constructor
     * @param  {WeekDay} day - День недели в который проводится занятие
     * @param  {Lesson} lesson - Объект, соответствующий времени проведения 
     *     занятия.
     */
    constructor(day, lesson){
        this.partsCount = 1;
        this.parts = Utils.range(0, this.partsCount - 1, 1).map(i => new ItemPart());
        this.day = day;
        this.lesson = lesson;
    }

    /**
     * Устанавливает количество вариантов события и добавляет или удаляет 
     * элементы массива &lt;code>parts&lt;/code>
     * 
     * @param {number} partsCount - Количество вариантов события
     */
    setPartsCount(partsCount){
        while (this.parts.length > partsCount){
            this.parts.pop();
        }
        while (this.parts.length &lt; partsCount){
            this.parts.push(new ItemPart());
        }
        this.partsCount = partsCount;
    }
}


/**
 * Класс расписания, содержащий описания всех занятий и времени их проведения
 *
 * @property {num} lessonsCount - Максимальное количество занятий, которое может 
 *                                проводится в один день
 * @property {Lesson[]} lessons - Список временных промежутков занятий
 * @property {Item[]} items - Список занятий, добавленных в расписание
 */
class Schedule{
    constructor(){
        this.lessonsCount = 6
        this.lessons = Utils.range(0, this.lessonsCount + 1, 1).map((i) => new Lesson(i, this))
        this.items = []
    }

    /**
     * Выполняет поиск занятия в расписании, проводимый в определенный день 
     * недели и в опредленный временной интервал.
     * 
     * @param  {number} dayNo - Номер для недели в который проводится занятие
     * @param  {number} lessonNo - Номер временного промежутка в который 
     *     проводится занятия
     * @return {Item} Найденное занятие или &lt;code>undefined&lt;/code>
     */
    getItem(dayNo, lessonNo){
        return this.items.find(item => item.day.number == dayNo &amp;&amp; item.lesson.number == lessonNo);
    }

    /**
     * Добавляет занятие со стандартными свойствами, проводимое в определенное 
     * время в определенный день недели. 
     * 
     * @param  {WeekDay} day - День недели, в который проводится занятие
     * @param  {Lesson} lesson - Временной интервал, в который вроводится занятие
     * @return {Item} Созданный объект занятия
     */
    createItem(day, lesson){
        let item = new ScheduleItem(day, lesson)
        this.items.push(item)
        return item
    }

    /**
     * Удаляет занятие, проводимое в заданный момент времени из расписания.
     * 
     * @param  {WeekDay} day - День недели, в который проводится занятие
     * @param  {Lesson} lesson Временной интервал, в который вроводится занятие
     */
    remove(day, lesson){
        this.items = this.items.filter(item => item.day != day || item.lesson != lesson);
    }

    /**
     * Определяет наиболее раннее время в которое может начаться занятие.
     * 
     * @param  {number} lessonNumber - Номер временного интервала, во время 
     *     которого приходит занятие
     * @return {number} Время, выраженное в минутах начиная с полуночи
     */
    getEarlistTimeForLesson(lessonNumber){
        let earliest = 0;
        for(let i = lessonNumber - 1; i >= 0; i--){
            if (this.lessons[i].endTimeDefined){
                earliest = this.lessons[i].endTime;
                break;
            }else if (this.lessons[i].startTimeDefined){
                earliest = this.lessons[i].startTime;
                break;
            }
        }
        return earliest;
    }

    /**
     * Определяет наиболее позднее время в которое может начаться занятие.
     * 
     * @param  {number} lessonNumber - Номер временного интервала, во время 
     *     которого приходит занятие
     * @return {number} Время, выраженное в минутах начиная с полуночи
     */
    getLatestTimeForLesson(lessonNumber){
        let latest = 23 * 60 + 59;
        for (let i = lessonNumber + 1; i &lt; this.lessons.length; i++){
            if (this.lessons[i].startTimeDefined){
                latest = this.lessons[i].startTime;
                break;
            }else if (this.lessons[i].endTimeDefined){
                latest = this.lessons[i].endTime;
                break;
            }
        }
        return latest;
    }

}

module.exports = Schedule</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Sun Apr 23 2017 17:56:27 GMT+0300 (MSK) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
